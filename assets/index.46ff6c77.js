var D=Object.defineProperty;var y=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var k=(e,t,n)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,m=(e,t)=>{for(var n in t||(t={}))S.call(t,n)&&k(e,n,t[n]);if(y)for(var n of y(t))x.call(t,n)&&k(e,n,t[n]);return e};import{j as N,a as A,F as E,u as b,d as g,D as O,b as L,l as f,y as T,R as B,c as _,S as F}from"./vendor.b5c76bd1.js";const P=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}};P();var c;(function(e){e.kanai_ofuna="kanai_ofuna",e.ofuna_kanai="ofuna_kanai",e.kanai_totsuka="kanai_totsuka",e.totsuka_kanai="totsuka_kanai"})(c||(c={}));var l;(function(e){e.weekday="weekday",e.saturday="saturday",e.holiday="holiday"})(l||(l={}));const C="https://calbert1209.github.io/json-api";function H(e){return Object.keys(e).filter(t=>Number.isNaN(+t))}c.kanai_ofuna+"",c.ofuna_kanai+"",c.kanai_totsuka+"",c.totsuka_kanai+"";const I=H(c).map(e=>`${C}/${e}.json`),M=async e=>{const t=e.map(s=>window.fetch(s)),n=[];for(const s of t)try{const o=await(await s).json();n.push(o)}catch(r){console.error(r)}return n.reduce((s,r)=>{const o=r.name;return s[o]=r,s},{})},a=N,h=A,p=E,R=({data:e})=>{const[t,n]=b(),s=Object.keys(e).join("-"),r=g(()=>Object.entries(e).map(([o,i])=>{const u=o.split("_").join("/"),d=i.header.busStop.substring(0,2),$=i.header.dest.substring(0,2),v=`${d} \u2192 ${$}`;return{key:o,label:v,path:`/${u}`}}),[s]);return h(p,{children:[a("h1",{children:"Bus Warbler"}),a("div",{class:"buttonMenu",children:r.map(({key:o,label:i,path:u})=>a("button",{class:"routeButton",onClick:()=>n(u),children:i},o))})]})},U=(e=new Date)=>{const t=e.getDay();return t===0?l.holiday:t===6?l.saturday:l.weekday},W={scheduleType:l.weekday},j=O(W),q=({children:e})=>{const t=U();return a(j.Provider,{value:{scheduleType:t},children:e})},K=()=>L(j),z=(e,t)=>`${e}_${t}`,G=(e=new Date)=>{let t=e.getHours();const n=e.getMinutes();return t*60+n},w=e=>`${e<10?"0":""}${e}`,J=({stopName:e,dest:t,data:n,scheduleType:s})=>{if(!n)return null;const r=z(e,t),o=n[r];if(!o)return null;const i=G();let u=[];for(const d of o.times){if(u.length>3)break;d.index<i||d.type!==s||u.push(d)}return u},Q=({stopName:e,dest:t,data:n})=>{const{scheduleType:s}=K();return g(()=>J({stopName:e,dest:t,scheduleType:s,data:n}),[e,t,n,s])},V=({hour:e,minute:t,note:n})=>h("div",{children:[a("span",{children:w(e)}),a("span",{children:":"}),a("span",{children:w(t)}),n&&a("span",{children:`( ${n} )`})]}),X=({stopName:e,dest:t,data:n})=>{const s=Q({stopName:e,dest:t,data:n}),[r,o]=b();return h(p,{children:[a("button",{onClick:()=>o("/"),children:"back"}),(s==null?void 0:s.length)?s.map(i=>a(V,m({},i),i.index)):a("div",{children:"no data found"})]})};function Y(){const[e,t]=f(!0),[n,s]=f(null),[r,o]=f(null);return T(()=>{M(I).then(i=>{console.log(i),o(i),t(!1)}).catch(s)},[]),e?a("h1",{children:"loading..."}):n?h(p,{children:[a("h1",{children:"Error occurred"}),a("div",{children:`${n}`})]}):r?a(q,{children:h(B,{base:"/preact-bus-warbler",children:[a(_,{path:"/",children:a(R,{data:r})}),a(_,{path:"/:stopName/:dest",children:({stopName:i,dest:u})=>a(X,{stopName:i,dest:u,data:r})})]})}):a("h1",{children:"Could not fetch data"})}F(a(Y,{}),document.getElementById("app"));
