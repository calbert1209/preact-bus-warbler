var S=Object.defineProperty;var y=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var k=(e,t,n)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,m=(e,t)=>{for(var n in t||(t={}))x.call(t,n)&&k(e,n,t[n]);if(y)for(var n of y(t))N.call(t,n)&&k(e,n,t[n]);return e};import{j as A,a as E,F as O,u as b,d as g,D as L,b as T,l as f,y as P,R as B,c as _,S as F}from"./vendor.b5c76bd1.js";const C=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}};C();var i;(function(e){e.kanai_ofuna="kanai_ofuna",e.ofuna_kanai="ofuna_kanai",e.kanai_totsuka="kanai_totsuka",e.totsuka_kanai="totsuka_kanai"})(i||(i={}));var l;(function(e){e.weekday="weekday",e.saturday="saturday",e.holiday="holiday"})(l||(l={}));const H="https://calbert1209.github.io/json-api";function I(e){return Object.keys(e).filter(t=>Number.isNaN(+t))}i.kanai_ofuna+"",i.ofuna_kanai+"",i.kanai_totsuka+"",i.totsuka_kanai+"";const M=I(i).map(e=>`${H}/${e}.json`),R=async e=>{const t=e.map(s=>window.fetch(s)),n=[];for(const s of t)try{const o=await(await s).json();n.push(o)}catch(r){console.error(r)}return n.reduce((s,r)=>{const o=r.name;return s[o]=r,s},{})},a=A,h=E,p=O,U=({data:e})=>{const[t,n]=b(),s=Object.keys(e).join("-"),r=g(()=>Object.entries(e).map(([o,u])=>{const c=o.split("_").join("/"),d=u.header.busStop.substring(0,2),w=u.header.dest.substring(0,2),D=`${d} \u2192 ${w}`;return{key:o,label:D,path:`/${c}`}}),[s]);return h(p,{children:[a("h1",{children:"Bus Warbler"}),a("div",{class:"buttonMenu",children:r.map(({key:o,label:u,path:c})=>a("button",{class:"routeButton",onClick:()=>n(c),children:u},o))})]})},W=(e=new Date)=>{const t=e.getDay();return t===0?l.holiday:t===6?l.saturday:l.weekday},q={scheduleType:l.weekday},$=L(q),K=({children:e})=>{const t=W();return a($.Provider,{value:{scheduleType:t},children:e})},z=()=>T($),G=(e,t)=>`${e}_${t}`,J=(e=new Date)=>{let t=e.getHours();const n=e.getMinutes();return t*60+n},j=e=>`${e<10?"0":""}${e}`,Q=({stopName:e,dest:t,data:n,scheduleType:s})=>{if(!n)return null;const r=G(e,t),o=n[r];if(!o)return null;const u=J();let c=[];for(const d of o.times){if(c.length>3)break;d.index<u||d.type!==s||c.push(d)}return c},V=({stopName:e,dest:t,data:n})=>{const{scheduleType:s}=z();return g(()=>Q({stopName:e,dest:t,scheduleType:s,data:n}),[e,t,n,s])},X=({hour:e,minute:t,note:n})=>h("div",{children:[a("span",{children:j(e)}),a("span",{children:":"}),a("span",{children:j(t)}),n&&a("span",{children:`( ${n} )`})]}),Y=({stopName:e,dest:t,data:n})=>{const s=V({stopName:e,dest:t,data:n}),[r,o]=b();return h(p,{children:[a("button",{onClick:()=>o("/"),children:"back"}),(s==null?void 0:s.length)?s.map(u=>a(X,m({},u),u.index)):a("div",{children:"no data found"})]})},v=e=>`preact-bus-warbler/${e}`;function Z(){const[e,t]=f(!0),[n,s]=f(null),[r,o]=f(null);return P(()=>{R(M).then(u=>{console.log(u),o(u),t(!1)}).catch(s)},[]),e?a("h1",{children:"loading..."}):n?h(p,{children:[a("h1",{children:"Error occurred"}),a("div",{children:`${n}`})]}):r?a(K,{children:h(B,{children:[a(_,{path:v("/"),children:a(U,{data:r})}),a(_,{path:v("/:stopName/:dest"),children:({stopName:u,dest:c})=>a(Y,{stopName:u,dest:c,data:r})})]})}):a("h1",{children:"Could not fetch data"})}F(a(Z,{}),document.getElementById("app"));
